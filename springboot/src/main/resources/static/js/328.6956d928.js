"use strict";(self["webpackChunkvue"]=self["webpackChunkvue"]||[]).push([[328],{6328:function(t,e,a){a.r(e),a.d(e,{default:function(){return m}});a(7658);var s=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticStyle:{"margin-bottom":"20px"}},[e("el-input",{staticStyle:{width:"240px"},attrs:{placeholder:"请输入用户名"},model:{value:t.params.username,callback:function(e){t.$set(t.params,"username",e)},expression:"params.username"}}),e("el-input",{staticStyle:{width:"240px","margin-left":"5px"},attrs:{placeholder:"请输入联系方式"},model:{value:t.params.phone,callback:function(e){t.$set(t.params,"phone",e)},expression:"params.phone"}}),e("el-input",{staticStyle:{width:"240px","margin-left":"5px"},attrs:{placeholder:"请输入邮箱"},model:{value:t.params.email,callback:function(e){t.$set(t.params,"email",e)},expression:"params.email"}}),e("el-button",{staticStyle:{"margin-left":"5px"},attrs:{type:"primary"},on:{click:t.load}},[e("i",{staticClass:"el-icon-search"}),t._v(" 搜索")]),e("el-button",{staticStyle:{"margin-left":"5px"},attrs:{type:"warning"},on:{click:t.reset}},[e("i",{staticClass:"el-icon-refresh"}),t._v(" 重置")])],1),e("el-table",{attrs:{data:t.tableData,stripe:""}},[e("el-table-column",{attrs:{prop:"id",label:"编号",width:"80"}}),e("el-table-column",{attrs:{prop:"username",label:"用户名"}}),e("el-table-column",{attrs:{prop:"phone",label:"联系方式"}}),e("el-table-column",{attrs:{prop:"email",label:"邮箱"}}),e("el-table-column",{attrs:{prop:"createtime",label:"创建时间"}}),e("el-table-column",{attrs:{prop:"updatetime",label:"更新时间"}}),e("el-table-column",{attrs:{label:"状态",width:"230"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},on:{change:function(e){return t.changeStatus(a.row)}},model:{value:a.row.status,callback:function(e){t.$set(a.row,"status",e)},expression:"scope.row.status"}})]}}])}),e("el-table-column",{attrs:{label:"操作",width:"230"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.$router.push("/editAdmin?id="+a.row.id)}}},[t._v("编辑")]),e("el-popconfirm",{staticStyle:{"margin-left":"5px"},attrs:{title:"您确定删除这行数据吗？"},on:{confirm:function(e){return t.del(a.row.id)}}},[e("el-button",{attrs:{slot:"reference",type:"danger"},slot:"reference"},[t._v("删除")])],1),e("el-button",{staticStyle:{"margin-left":"5px"},attrs:{type:"warning"},on:{click:function(e){return t.handleChangePass(a.row)}}},[t._v("修改密码")])]}}])})],1),e("div",{staticStyle:{"margin-top":"20px"}},[e("el-pagination",{attrs:{background:"","current-page":t.params.pageNum,"page-size":t.params.pageSize,layout:"prev, pager, next",total:t.total},on:{"current-change":t.handleCurrentChange}})],1),e("el-dialog",{attrs:{title:"修改密码",visible:t.dialogFormVisible,width:"30%"},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[e("el-form",{ref:"formRef",attrs:{model:t.form,"label-width":"100px",rules:t.rules}},[e("el-form-item",{attrs:{label:"新密码",prop:"newPass"}},[e("el-input",{attrs:{autocomplete:"off","show-password":""},model:{value:t.form.newPass,callback:function(e){t.$set(t.form,"newPass",e)},expression:"form.newPass"}})],1)],1),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary"},on:{click:t.savePass}},[t._v("确 定")])],1)],1)],1)},r=[],l=a(4471),i=a(680),o={name:"AdminList",data(){return{admin:i.Z.get("admin")?JSON.parse(i.Z.get("admin")):{},tableData:[],total:0,form:{},dialogFormVisible:!1,params:{pageNum:1,pageSize:10,username:"",phone:"",email:""},rules:{newPass:[{required:!0,message:"请输入新密码",trigger:"blur"},{min:3,max:10,message:"长度在3-10个字符",trigger:"blur"}]}}},created(){this.load()},methods:{changeStatus(t){if(this.admin.id===t.id&&!t.status)return t.status=!0,void this.$notify.warning("您的操作不合法");l.Z.put("/admin/update",t).then((t=>{"200"===t.code?(this.$notify.success("操作成功"),this.load()):this.$notify.error(t.msg)}))},handleChangePass(t){this.form=JSON.parse(JSON.stringify(t)),this.dialogFormVisible=!0},savePass(){this.$refs["formRef"].validate((t=>{t&&l.Z.put("/admin/password",this.form).then((t=>{"200"===t.code?(this.$notify.success("修改成功"),this.form.id===this.admin.id?(i.Z.remove("admin"),this.$router.push("/login")):(this.load(),this.dialogFormVisible=!1)):this.$notify.error("修改失败")}))}))},load(){l.Z.get("/admin/page",{params:this.params}).then((t=>{"200"===t.code&&(this.tableData=t.data.list,this.total=t.data.total)}))},reset(){this.params={pageNum:1,pageSize:10,username:"",phone:"",email:""},this.load()},handleCurrentChange(t){this.params.pageNum=t,this.load()},del(t){l.Z["delete"]("/admin/delete/"+t).then((t=>{"200"===t.code?(this.$notify.success("删除成功"),this.load()):this.$notify.error(t.msg)}))}}},n=o,p=a(1001),u=(0,p.Z)(n,s,r,!1,null,"025c1360",null),m=u.exports}}]);
//# sourceMappingURL=328.6956d928.js.map